<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Flavors - Robotnix</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Robotnix</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="flavors"><a class="header" href="#flavors">Flavors</a></h1>
<p>In normal usage, the user needs to select a robotnix "flavor" in their configuration file by setting the <code>flavor</code> option.
Flavors may change the default settings of some other modules, which might not match the default setting shown on the <a href="options.html">Options</a> reference page.
As an example, the GrapheneOS flavor enables <code>apps.vanadium.enable</code> by default.
For further details, consult the implementation of the flavor under (for example) <code>flavors/grapheneos/*</code>.</p>
<p>Currently, the vanilla and GrapheneOS flavors are based on Android 12, while the LineageOS flavor uses either Android 10 or Android 11, depending on the device.
If a robotnix flavor supports multiple Android versions (either older or experimental newer versions),
this can be overridden by setting (for example) <code>androidVersion = 11</code>.</p>
<h2 id="vanilla"><a class="header" href="#vanilla">Vanilla</a></h2>
<p>The vanilla flavor is meant to represent a (mostly) unaltered version of the AOSP code published by Google.
Vanilla AOSP support may be enabled by setting <code>flavor = "vanilla";</code>.
It does, however, include some small fixes and usability improvements.
Enabling the vanilla flavor also enables the chromium webview/app by default as well.</p>
<p>The vanilla flavor in robotnix currently supports only Pixel phones which still receive updates from Google (&gt;= Pixel 3a).
Older Pixel phones (e.g. <code>marlin</code> / Pixel 1 XL) may be still be built by overriding <code>androidVersion = 10;</code>.
However, these might be removed in the future as they are no longer receiving device updates from Google.</p>
<p>The vanilla flavor retains working support for Android Verified Boot,
and allows a user to re-lock the bootloader using the user's own generated root of trust.</p>
<h2 id="grapheneos"><a class="header" href="#grapheneos">GrapheneOS</a></h2>
<p>GrapheneOS is a privacy and security focused mobile OS with Android app compatibility developed as a non-profit open source project.
GrapheneOS support may be enabled by setting <code>flavor = "grapheneos";</code>.
Enabling the GrapheneOS flavor will also enable the Vanadium app/webview and Seedvault robotnix modules.
Additionally, the upstream GrapheneOS updater is disabled,
but the robotnix updater app (based on the GrapheneOS updater app) can be enabled by setting <code>apps.updater.enable = true;</code> and <code>apps.updater.url = "...";</code>.</p>
<p>The user should understand that enabling certain robotnix modules may have security implications as they produce a may produce a larger attack surface than is intended by the GrapheneOS project.
Some modules, such as the MicroG and the F-Droid privileged extension, have been explicitly rejected by upstream GrapheneOS.
If the user wishes to enable these modules, they should understand and be willing to accept the usability/security tradeoffs.</p>
<p>GrapheneOS releases are tagged in robotnix, but before 2021.05.16.04, the date suffix (YY.MM.DD.HH) did not match the one used in the upstream release.
Only the latest GrapheneOS release is included with robotnix, even if that release is only a "beta" release upstream.
If you would prefer to stick to only stable releases, wait until the release is marked "stable" upstream.</p>
<p>Before reporting bugs to upstream GrapheneOS, please ensure that you can reproduce your issue using the official GrapheneOS images.
Alternatively, feel free to ask about your issue on the <code>#robotnix:nixos.org</code> channel on Matrix.</p>
<h2 id="lineageos"><a class="header" href="#lineageos">LineageOS</a></h2>
<p>LineageOS is a free and open-source operating system for various devices, based on the Android mobile platform.
LineageOS support may be enabled by setting <code>flavor = "lineageos";</code>.
At the time of writing, this includes support for ~160 devices.</p>
<p>Robotnix includes support for LineageOS 20.0 to 22.1 (some older releases are also present but unmaintained).
By default, robotnix will select the latest supported version for the device specified in the configuration.
This can be overridden by setting the corresponding <code>androidVersion</code>. Here is the correspondance table of the supported Robotnix version:</p>
<div class="table-wrapper"><table><thead><tr><th><code>androidVersion</code></th><th>LineageOS version</th></tr></thead><tbody>
<tr><td>10</td><td>17.1</td></tr>
<tr><td>11</td><td>18.1</td></tr>
<tr><td>12</td><td>19.1</td></tr>
<tr><td>13</td><td>20.0</td></tr>
<tr><td>14</td><td>21.0</td></tr>
<tr><td>15</td><td>22.1</td></tr>
</tbody></table>
</div>
<p>Since LineageOS does not produce tagged releases like vanilla AOSP or GrapheneOS,
we periodically take snapshots of the upstream repositories and include metadata in robotnix which pins the source repositories to particular revisions.
This metadata can be found under <code>flavors/lineageos/*/*.json</code>.</p>
<p>LineageOS support in robotnix should be considered "experimental," as it does yet have the same level of support provided for <code>vanilla</code> and <code>grapheneos</code> flavors.
LineageOS source metadata may be updated irregularly in robotnix, and certain modules (such as the updater) are not guaranteed to work.
Moreover, LineageOS does not appear to provide the same level of security as even the vanilla flavor, as it disables dm-verity/AVB, sets <code>userdebug</code> as the default variant, and uses vendor files with unclear origin.
LineageOS support is still valuable to include as it extends support to a much wider variety of devices, and provides the base that many other Android ROMs use to customize.
Contributions and fixes from LineageOS users are especially welcome!</p>
<p>For devices with "boot-as-recovery", the typical LineageOS flashing process involves first producing a <code>boot.img</code> and <code>ota</code>, flashing <code>boot.img</code> with fastboot, and then sideloading the <code>ota</code> in recovery mode.
The <code>boot.img</code> and <code>ota</code> targets can be built using <code>nix-build ... -A bootImg</code> or <code>nix-build ... -A ota</code>, respectively.
Check the upstream documentation for your particular device before following the above instructions.</p>
<p>To add a support for a particular device, add its code to <code>./flavors/lineageos/supported_devices.toml</code>, then run <code>nix-shell</code>, then <code>./flavors/lineageos/update.sh -s &lt;lineageos_branch&gt;</code>.</p>
<h3 id="note-on-signing"><a class="header" href="#note-on-signing">Note on signing</a></h3>
<p>When you build a LineageOS image, the system image is cryptographically signed by default. There are three options concerning the keys the image can be signed with:</p>
<ul>
<li>the official LineageOS keys (release-keys). We don't have access to them, so the only images signed with these keys are the official LineageOS builds. If you previously installed LineageOS from official sources, these are the keys you are currently using.</li>
<li>the test keys (test-keys). These keys are publicly available, and Robotnix uses them by default.</li>
<li>your own release keys. Please see <a href="../building.html#building-and-signing-releases">the relevant section in the Building page</a>.</li>
</ul>
<p>When you run LineageOS and install apps that save stuff to your phone, that data is "coupled" to the keys your LineageOS install was signed with. If you try to boot a LineageOS install with an image that was signed with different build keys than the ones your user data was coupled to, it will complain and not boot at best (or you'll loose all your data at worse).</p>
<p>In that case, you have two options:</p>
<ul>
<li>you can wipe your userdata partition and start over with the new keys</li>
<li>or you can migrate your userdata from the keys of your old install to your new install</li>
</ul>
<p>To do the latter, please see <a href="https://wiki.lineageos.org/signing_builds#using-a-script">the official documentation</a>.</p>
<h2 id="anbox"><a class="header" href="#anbox">Anbox</a></h2>
<p>Anbox is a Free and open-source container-based approach at running Android on Linux systems.
Anbox support may be enabled by setting <code>flavor = "anbox";</code>.</p>
<p>At the time of writing, support is experimental.
Given that Anbox is based on an older Android release (7), support for Robotnix options is not guaranteed.</p>
<h2 id="waydroid"><a class="header" href="#waydroid">Waydroid</a></h2>
<p>Waydroid is a Free and open-source container-based approach at running Android on Linux systems.
Waydroid support may be enabled by setting device and flavor, e.g. <code>device="x86_64"; flavor="waydroid";</code>.
LineageOS based system/vendor images can be built using <code>nix-build ... -A config.build.waydroid</code>.</p>
<p>At the time of writing, support is experimental.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../configuration.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../modules/f-droid.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../configuration.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../modules/f-droid.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
